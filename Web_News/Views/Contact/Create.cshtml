@model Web_News.ViewModels.ContactViewModel

@{
    ViewBag.Title = "Liên hệ quảng cáo";
}

<h2>Liên hệ quảng cáo</h2>
<br />
<br />
<br />
<br />
<br />
<form asp-action="Create" method="post" enctype="multipart/form-data" id="contactForm">
    <div asp-validation-summary="ModelOnly" class="text-danger"></div>

    <div class="form-group">
        <label asp-for="ContactName"></label>
        <input asp-for="ContactName" class="form-control" required />
        <span asp-validation-for="ContactName" class="text-danger"></span>
    </div>

    <div class="form-group">
        <label asp-for="Content"></label>
        <input asp-for="Content" class="form-control" required />
        <span asp-validation-for="Content" class="text-danger"></span>
    </div>

    <div class="form-group">
        <label asp-for="MediaFile">Chọn ảnh, video hoặc ảnh động</label>
        <input asp-for="MediaFile" type="file" class="form-control" accept="image/*,video/*" required />
        <span id="imageError" class="text-danger" style="display:none;"></span>
    </div>

    <div class="form-group">
        <label asp-for="Link"></label>
        <input asp-for="Link" class="form-control" />
        <span asp-validation-for="Link" class="text-danger"></span>
    </div>

    <button type="submit" class="btn btn-primary">Gửi liên hệ</button>
</form>

@section Scripts {
    @* Thêm script để xử lý validation *@
    <partial name="_ValidationScriptsPartial" />
    <script>
        document.getElementById('contactForm').addEventListener('submit', function(event) {
            var fileInput = document.querySelector('input[name="MediaFile"]');
            var errorSpan = document.getElementById('imageError');

            if (fileInput.files.length === 0) {
                errorSpan.textContent = 'Vui lòng chọn một ảnh.';
                errorSpan.style.display = 'block';
                event.preventDefault();
                return;
            }

            var file = fileInput.files[0];
            if (file.type.startsWith('image/')) {
                var img = new Image();

                var reader = new FileReader();
                reader.onload = function(e) {
                    img.src = e.target.result;
                    img.onload = function() {
                        // Kiểm tra kích thước (ví dụ: chiều rộng tối đa 800px, chiều cao tối đa 600px)
                        if (img.width > 300 || img.height > 200) {
                            errorSpan.textContent = 'Ảnh phải có kích thước tối đa là 800x600 px.';
                            errorSpan.style.display = 'block';
                            event.preventDefault();
                        } else {
                            errorSpan.style.display = 'none';
                        }
                    };
                };
                reader.readAsDataURL(file);
            } else {
                errorSpan.textContent = 'Vui lòng chọn một ảnh. (Hỗ trợ chỉ hình ảnh)';
                errorSpan.style.display = 'block';
                event.preventDefault();
            }
        });
    </script>
}
