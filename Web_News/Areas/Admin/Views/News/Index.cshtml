@model IEnumerable<Web_News.Areas.Admin.ViewModels.NewsViewModel>

@{
    ViewData["Title"] = "All News";
    var statusFilter = ViewData["StatusFilter"]?.ToString();
}
<p>
    <a asp-action="Create" class="btn btn-success">Tạo bài viết</a>
</p>

<div class="col-lg-12 grid-margin stretch-card">
    <div class="card">
        <div class="card-body">
            <div class="btn-group" role="group">
                <!-- Nút để lọc theo trạng thái "Đang chờ duyệt" -->
                <form method="get" action="@Url.Action("FilterByStatus", "News")">
                    <input type="hidden" name="status" value="Pending" />
                    <button type="submit" class="btn  @(ViewData["StatusFilter"]?.ToString() == "Pending" ? "btn-dark" : "btn-outline-secondary")">Đang chờ duyệt</button>
                </form>

                <!-- Nút để lọc theo trạng thái "Duyệt" -->
                <form method="get" action="@Url.Action("FilterByStatus", "News")">
                    <input type="hidden" name="status" value="Approved" />
                    <button type="submit" class="btn  @(ViewData["StatusFilter"]?.ToString() == "Approved" ? "btn-dark" : "btn-outline-secondary")">Duyệt</button>
                </form>

                <!-- Nút để lọc theo trạng thái "Từ chối" -->
                <form method="get" action="@Url.Action("FilterByStatus", "News")">
                    <input type="hidden" name="status" value="Rejected" />
                    <button type="submit" class="btn   @(ViewData["StatusFilter"]?.ToString() == "Rejected" ? "btn-dark" : "btn-outline-secondary")">Từ chối</button>
                </form>
            </div>
            <hr />
            <table class="table table-striped">
                <thead>
                    <tr>
                        <th style="font-weight: bold;">Ảnh</th>
                        <th style="font-weight: bold;">Tiêu đề</th>
                        <th style="font-weight: bold;">Ngày viết</th>
                        <th style="font-weight: bold;">Người viết</th>
                        <th style="font-weight: bold;">Thể loại</th>
                        <th style="font-weight: bold;">Trạng thái</th>
                        <th style="font-weight: bold;">Thao tác</th>
                    </tr>
                </thead>
                <tbody>
                    @foreach (var item in Model)
                    {
                        <tr>
                            <td>
                                <img src="/Images/@item.Image" style="max-width: 150px; height: auto; border-radius: 5px;" />
                            </td>
                            <td title="@item.Title">
                                @(item.Title.Length > 45 ? item.Title.Substring(0, 45) + "..." : item.Title)
                            </td>

                            <td>@item.PublishDate</td>
                            <td>@item.CreatedByUserName</td>
                            <td>
                                @if (item.ListCategories != null && item.ListCategories.Count > 0)
                                {
                                    var displaycate = item.ListCategories.Take(2);
                                    <!-- Hiển thị 3 danh mục -->
                                    foreach (var category in displaycate)
                                    {
                                        <span class="badge bg-secondary">@category.NameCategory</span>
                                    }
                                    @if (item.ListCategories.Count > 2)
                                    {
                                        <span>...</span> <!-- Thêm dấu "..." nếu có nhiều hơn 3 danh mục -->
                                    }
                                }
                            </td>

                            <td>
                                @if (item.Status)
                                {
                                    <span class="badge bg-danger">On</span>
                                }
                                else
                                {
                                    <span class="badge bg-dark">Off</span>
                                }
                            </td>
                            <td>
                                <a asp-action="Details" asp-route-id="@item.NewsId" class="btn btn-info btn-sm">Details</a>
                                <a asp-action="Edit" asp-route-id="@item.NewsId" class="btn btn-primary btn-sm">Edit</a>
                                <a asp-action="Delete" asp-route-id="@item.NewsId" class="btn btn-danger btn-sm">Delete</a>
                            </td>
                        </tr>
                    }
                </tbody>
            </table>
        </div>
    </div>
</div>